(this["webpackJsonpkomoot-challenge"]=this["webpackJsonpkomoot-challenge"]||[]).push([[0],{28:function(e,t,n){e.exports=n(60)},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},40:function(e,t){},42:function(e,t){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(26),c=n.n(i),s=(n(33),n(4)),r=(n(34),n(35),n(27)),l=n.n(r),u=function(e){return l()({gpx:[{_attr:{version:"1.1",creator:"Route Builder",xmlns:"http://www.topografix.com/GPX/1/1","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"}},{metadata:[{name:"Hiking route"}]},{trk:[{name:"Hiking route"},{trkseg:e.map(d)}]}]},{declaration:!0,indent:"  "})},d=function(e){return{trkpt:[{_attr:{lat:e.lat,lon:e.lng}}]}},m=function(e){var t=e.waypoints;return o.a.createElement("a",{href:p(u(t)),className:"DownloadButton",target:"_blank",download:"route.gpx"},"Download your Route")},p=function(e){return URL.createObjectURL(new Blob([e],{type:"application/xml"}))},h=n(2),g=function(e,t){return[].concat(Object(h.a)(t.slice(0,e)),Object(h.a)(t.slice(e+1)))},f=function(e,t,n){return[].concat(Object(h.a)(n.slice(0,e)),[t],Object(h.a)(n.slice(e)))},v=(n(52),n(53),function(e){var t=e.name,n=e.className,a=void 0===n?"":n;return o.a.createElement("span",{className:"Icon Icon--"+t+" "+a})}),b=(n(54),n(55),function(e){var t=e.onClick;return o.a.createElement("button",{className:"DeleteButton",onClick:t},o.a.createElement(v,{name:"delete"}))}),x=function(e){var t=e.className,n=e.index,o=e.onMove;return{onDragEnter:Object(a.useCallback)((function(e){e.currentTarget.classList.add(t)}),[t]),onDragLeave:Object(a.useCallback)((function(e){e.currentTarget.classList.remove(t)}),[t]),onDragOver:Object(a.useCallback)((function(e){e.preventDefault()}),[]),onDrop:Object(a.useCallback)((function(e){e.preventDefault(),e.currentTarget.classList.remove(t);var a=Number(e.dataTransfer.getData("text/plain"));o(a,n)}),[n,o,t])}},k=function(e){for(var t=[],n=0,a=Object.entries(e);n<a.length;n++){var o=Object(s.a)(a[n],2),i=o[0];o[1]&&t.push(i)}return t.join(" ")},y=function(e){var t=e.index,n=e.selected,i=e.onDelete,c=e.onMove,s=e.onSelectedIndexChange,r=Object(a.useCallback)((function(){return i(t)}),[t,i]),l=Object(a.useCallback)((function(e){e.dataTransfer.dropEffect="move",e.dataTransfer.setData("text/plain",String(t))}),[t]),u=x({className:"WaypointListItem--target",index:t,onMove:c});return o.a.createElement("li",Object.assign({className:k({WaypointListItem:!0,"WaypointListItem--selected":n}),draggable:!0,onDragStart:l},u,{onMouseEnter:Object(a.useCallback)((function(){return s(t)}),[s,t]),onMouseLeave:Object(a.useCallback)((function(){return s(void 0)}),[s])}),o.a.createElement(v,{name:"draggable",className:"WaypointListItem_grip"}),o.a.createElement("span",null,"Waypoint ",t+1),o.a.createElement(b,{onClick:r}))},j=(n(56),function(e){var t=e.index,n=e.onMove,a=x({className:"ExtraDropZone--target",index:t,onMove:n});return o.a.createElement("li",Object.assign({className:"ExtraDropZone"},a))}),O=function(e){var t=e.waypoints,n=e.selectedIndex,i=e.onChange,c=e.onSelectedIndexChange,s=Object(a.useCallback)((function(e){i(g(e,t))}),[t,i]),r=Object(a.useCallback)((function(e,n){i(function(e,t,n){var a=n[e];return e<t?g(e,f(t,a,n)):e>t?f(t,a,g(e,n)):n}(e,n,t))}),[t,i]);return o.a.createElement("ul",{className:"WaypointList"},t.map((function(e,t){return o.a.createElement(y,{key:t,index:t,onDelete:s,onMove:r,selected:t===n,onSelectedIndexChange:c})})),o.a.createElement(j,{index:t.length,onMove:r}))},w=(n(57),n(12)),I=n(13),C=(n(58),n(1)),E=(n(59),function(e,t){return C.divIcon({html:"".concat(e+1),className:k({NumberedIcon:!0,"NumberedIcon--selected":t}),iconSize:[25,25]})}),L=function(){function e(t,n){Object(w.a)(this,e),this.map=void 0,this.latlngs=[],this.markers=[],this.polyline=void 0,this.selectedIndex=void 0,this.events=void 0,this.map=t,this.events=n,this.polyline=C.polyline([],{weight:6}).addTo(t)}return Object(I.a)(e,[{key:"addLatLng",value:function(e){this.latlngs=[].concat(Object(h.a)(this.latlngs),[e]),this.polyline.addLatLng(e),this.markers.push(this.createMarker(e,this.markers.length).addTo(this.map)),this.events.onChange(this.latlngs)}},{key:"createMarkers",value:function(e){var t=this;return e.map(this.createMarker,this).map((function(e){return e.addTo(t.map)}))}},{key:"createMarker",value:function(e,t){var n=this;return function(e){var t=e.latlng,n=e.index,a=e.icon,o=e.onDrag,i=e.onDragEnd,c=e.onSelectedIndexChange,s=C.marker(t,{icon:a,draggable:!0}),r=!1;return s.on("dragstart",(function(){r=!0})),s.on("drag",(function(){o(n,s.getLatLng())})),s.on("dragend",(function(){i(),r=!1})),s.on("mouseover",(function(){r||c(n)})),s.on("mouseout",(function(){r||c(void 0)})),s}({index:t,latlng:e,icon:E(t,t===this.selectedIndex),onDrag:this.updatePolylineAt.bind(this),onDragEnd:function(){return n.events.onChange(n.latlngs)},onSelectedIndexChange:this.events.onSelectedIndexChange})}},{key:"updatePolylineAt",value:function(e,t){this.latlngs=function(e,t,n){return[].concat(Object(h.a)(n.slice(0,e)),[t],Object(h.a)(n.slice(e+1)))}(e,t,this.latlngs),this.polyline.setLatLngs(this.latlngs)}},{key:"setLatLngs",value:function(e){var t,n,a=this;(t=this.latlngs,n=e,t.length===n.length&&t.every((function(e,t){return e.equals(n[t])})))||(this.latlngs=e,this.polyline.setLatLngs(this.latlngs),this.markers.forEach((function(e){return e.removeFrom(a.map)})),this.markers=this.createMarkers(this.latlngs))}},{key:"setSelected",value:function(e){void 0!==this.selectedIndex&&this.markers[this.selectedIndex]&&this.markers[this.selectedIndex].setIcon(E(this.selectedIndex,!1)),void 0!==e&&this.markers[e].setIcon(E(e,!0)),this.selectedIndex=e}}]),e}(),S=new C.LatLng(58.3728214,21.8631477),M=function(){function e(t,n){var a=this;Object(w.a)(this,e),this.map=void 0,this.polyline=void 0,this.map=C.map(t).setView(S,12),navigator.geolocation.getCurrentPosition((function(e){var t=e.coords;a.map.setView([t.latitude,t.longitude],12)})),C.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicmVua3UiLCJhIjoiY2tnZmVzZGdtMHB6MDJzbmFoMmRzdms2eCJ9.lStxev2R9jj1QV-MvNRFtQ"}).addTo(this.map),this.polyline=new L(this.map,n),this.map.on("click",(function(e){var t=e.latlng;return a.polyline.addLatLng(t)}))}return Object(I.a)(e,[{key:"updateWaypoints",value:function(e){this.polyline.setLatLngs(e)}},{key:"setSelectedWaypoint",value:function(e){this.polyline.setSelected(e)}}]),e}(),N=function(e){var t=e.waypoints,n=e.selectedIndex,i=e.onChange,c=e.onSelectedIndexChange,r=Object(a.useState)(),l=Object(s.a)(r,2),u=l[0],d=l[1],m=Object(a.useRef)(null);return Object(a.useEffect)((function(){!u&&m.current&&d(new M(m.current.id,{onChange:i,onSelectedIndexChange:c}))}),[m,u,d,i,c]),Object(a.useEffect)((function(){u&&u.updateWaypoints(t)}),[u,t]),Object(a.useEffect)((function(){u&&u.setSelectedWaypoint(n)}),[u,n]),o.a.createElement("div",{className:"Map",id:"mapid",ref:m})},D=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(void 0),r=Object(s.a)(c,2),l=r[0],u=r[1];return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"App__sidebar"},o.a.createElement("h1",{className:"App__title"},"Route Builder"),o.a.createElement("div",{className:"App__list"},o.a.createElement(O,{waypoints:n,selectedIndex:l,onChange:i,onSelectedIndexChange:u})),o.a.createElement(m,{waypoints:n})),o.a.createElement("div",{className:"App__mapArea"},o.a.createElement(N,{waypoints:n,selectedIndex:l,onChange:i,onSelectedIndexChange:u})))};c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(D,null)),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.d9045521.chunk.js.map
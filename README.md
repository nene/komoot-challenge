# Komoot Challenge

## Assignment

Develop a react app that enables you to plan your cross country run and download it as GPX file.

Cross Country runners are not bound to the streets.
Your users can plan their favorite route across fields and
hills by just placing markers as waypoints on the map.
For detailed planning the same waypoints show up as a list where
users can delete and rearrange them until the route is perfect and ready to download.
The user interface should be based on the design to the left.

An excellent ReactJS Developer should manage to do this challenge in a few hours.
Impress us with your coding skills by not using 3rd party react components and plugins.
At least the map and the list should be separated react components.

Send us the sources as zip file, a link to the hosted solution and
what you have learned while developing.

## Building and running

```
yarn install
yarn start
```

## Browser support

Tested in a few recent browsers:

- Firefox 81
- Safari 14
- Chrome 86

No effort has been made to ensure any backwards-compatibility with older versions.

## Libraries and tools used

- [create-react-app][] for initial setup.
- Icon font generated by [IcoFont][].
- Using [Leaflet][] library for the map.
- Using the [node xml][] library for simple XML generation.
- Generated GPX file validated with [online XML validator][].

## Libraries not used

As it was recommended to not use 3rd party react components and plugins:

- [styled-components][] would normally be my goto choice for styling React apps.
  Here used just plain CSS with BEM-like naming scheme for classes: `Component__subComponent--state`.
- [lodash][], [ramda][] or some other utility lib.
  I needed some utilities for immutable operations with arrays,
  so implemented them on my own. Though these libs aren't really react-related.
- [classnames][] lib for easy creation of `className` prop values.
  Did a simplified implementation of this utility function.
- A state management library like [redux][].
  For such a small project, React component state filled all my needs.

## Shortcuts taken / Technical debt accumulated

- All values in CSS are hard-coded.
  Normally I would at least declare all colors as named constants.
- Hard-coded my personal Mapbox access token.
  Not the securest approach. But I have controls to turn that token off if needed.
- Hard-coded HTML element `id` in Map component.
  That will limit creating multiple instances of this component.
- Using the `Leaflet.LatLng` type throughout the code (even in non-map-related components).
  It would be better to avoid such tight coupling with the Leaflet library.

## UX Design

I saw two options for what should happen with waypoint numbers when rearranging them:

1.  Waypoints get renumbered.
    So their numbers will always correspond to their position.
    The downside is that after dragging items inside list, it feels like nothing happened,
    because seemingly no waypoints swapped positions.
2.  Waypoints keep their original numbering.
    This eliminates the downside of the previous approach,
    however it brings along problems of its own:
    - the numbers on map no more reflect the order the route is to be travelled,
    - it complicates assigning numbers to new waypoints.

Given the many downsides of the second option, I decided to implement the first approach.

Additional features that weren't explicitly called for in the assignment:

- Markers can be dragged on map to adjust their position after initial placement.
  This seemed like an essential thing to have.
- Hovering a marker highlights the corresponding list item and vice versa.
  This greatly reduces the mental burden of understanding which marker you're about to re-arrange or delete.
- Map is positioned according to user location when access given.

## What did I learn

- I had not used the browser Drag'n'Drop API before.
  It seemed to work pretty well in Firefox,
  but then I discovered it not quite working when testing in other browsers.
  Turned out I had used the deprecated dragexit event.
  Additionally I had problems with excessive dragleave events being fired,
  which I fixed with applying `pointer-events: none` to child elements.

[create-react-app]: https://create-react-app.dev/
[styled-components]: https://styled-components.com/
[node xml]: https://github.com/dylang/node-xml
[ramda]: https://ramdajs.com/
[lodash]: https://lodash.com/
[icofont]: https://www.icofont.com/
[online xml validator]: https://www.truugo.com/xml_validator/
[classnames]: https://www.npmjs.com/package/classnames
[leaflet]: https://leafletjs.com/
[redux]: https://redux.js.org/
